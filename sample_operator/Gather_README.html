<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>
      Gather Operator Sample
    </title>
    <link rel="stylesheet" type="text/css" href="''">
    <meta name="generator" content="DocBook XSL Stylesheets V1.76.1">
    <style type="text/css">
/* ++++++++++++++++++++++++++++++++++++++++++++++++++++++
    sb-readme.css : Styles for StreamBase Help READMEs
    ++++++++++++++++++++++++++++++++++++++++++++++++++++++ */
    body {
    background: #fff;
    text-align: left;
    font-family: "Trebuchet MS", Verdana, Arial, Helvetica, Tahoma, sans-serif;
    font-size: 10pt;
    padding: 10px;  
    margin: 0;
    }

    h1 {
    color: black;
    padding: 2px 0;
    border-top: none;
    font-size: 150%;
    font-weight: bold;
    text-align: center;
    margin: 0 0 0.75em 0px;
    }

    h2 {
    color: black;
    margin: 1em 0 0.75em 0;
    padding: 2px 0;
    font-size: 130%;
    font-weight: bold;
    border-top: 0.5px solid gray; 
    }

    h3 {
    color: black;
    margin: 1em 0 0.75em 0;
    padding: 2px 0;
    font-size: 120%;
    font-style: italic;
    font-weight: bold;
    width: 50%;
    border-top: 1px dashed;
    }

    h3.subtitle {
    color: black;
    text-align: center;
    border: none;
    margin: -1.25em 0 1em 0;
    padding: none;
    font-size: 120%;
    font-weight: bold;
    font-style: normal;
    width: 100%;
    }

    h4 {
    color: black;
    margin: 1em 0 0.75em 0;
    padding: 2px 0;
    border-top: none;
    font-size: 110%;
    font-weight: bold;
    }

    h5 {
    color: black;
    margin: 1em 0 0.5em 0;
    padding: 2px 0;
    font-size: 100%;
    font-style: italic;
    }

    h6 {
    color: black;
    margin: 1em 0 0.5em 0;
    padding: 2px 0;
    font-size: 100%;
    font-weight: bold;
    }

    table {
    border-collapse: collapse;
    border-left: 1px solid gray;
    border-top: 1px solid gray;
    font-family: "Trebuchet MS", Verdana, Arial, Helvetica, Tahoma, sans-serif;
    font-size: 10pt;
    }

    table.simplelist {
    border: none;
    }

    thead {
    line-height: 1em;
    }

    th {
    background: #ddeeff;
    text-align: left;
    padding: 6px 5px 5px;
    vertical-align: top;
    }

    td {
    padding: 6px 5px 5px;
    vertical-align: top;
    }

    table p {
    margin-bottom: 2px;
    margin-top: 3px;
    }

    ul, ol {
    margin-top: 1.0em;
    margin-bottom: 1.0em;
    margin-left: 1.5em;
    padding: 0 0 0 20px;
    }

    li {
    margin-top: 0;
    margin-bottom: 0;    
    }

    ol[compact] li p, ul[compact] li p {
    margin-top: 0;
    margin-bottom: 0.25em;
    }

    li p {
    margin-top: 0;
    margin-bottom: 0.5em;
    }

    div.variablelist {
    margin-left: 2em;
    }

    dt {
    font-size: 95%;
    font-weight: bold;
    margin-top: 8.0pt;
    margin-bottom: 1.0pt;
    }

    dd {
    margin-left: 1em;
    }

    div.column dt {
    font-size: 95%;
    font-weight: normal;
    margin-top: 0pt;
    margin-bottom: 1.0pt;
    }

    img {
    border: none;
    }

    blockquote {
    margin: 0 0 0 2em;
    padding: 5px 0;
    }

    span {
    margin: 0;
    padding: 0;
    }

    a {
    margin: 0;
    padding: 0;
    }

    a:link, a:visited {
    color: #003399;
    }

    a:hover {
    color: #ff0000;
    }

    span.guilabel, 
    span.guimenuitem, 
    span.guibutton {
    font-weight: bold;
    color: #333333;
    }

    .column { 
    padding: 2px; 
    }

    *.box {
    border: 1px solid blue;
    margin: 10px;
    background: #def;
    }

    *.box *.title{
    margin-top: 0;
    }

    *.box * {
    margin-left: 1em;
    }

    div.back2top {
    margin-top: 30px;
    }

    div.literallayout p {
    font-family: "Courier New", Courier, "Lucida Console", monospace;
    font-size: 95%;
    }

    div.note *.title,
    div.important *.title,
    div.caution *.title,
    div.tip *.title,
    div.warning *.title {
    margin: 0em 0em -0.85em 0em;
    font-size: 90%;
    }

    li div.note *.title, 
    li div.important *.title, 
    li div.caution *.title, 
    li div.tip *.title, 
    li div.warning *.title {
    margin: 0em 0em -0.2em 0em;
    font-size: 90%;
    }

    table div.note *.title,
    table div.important *.title,
    table div.caution *.title,
    table div.tip *.title,
    table div.warning *.title {
    margin: 0em 0em -0.5em 0em;
    font-size: 90%;
    }

    pre.programlisting {
    border: 1.0px solid gray;
    padding: 2px;
    background: #EEE;
    font-family: "Courier New", Courier, "Lucida Console", monospace;
    font-size: 95%;
    }

    pre.programlisting em.replaceable code {
    font-family: "Courier New", Courier, "Lucida Console", monospace;
    font-style: italic;
    }

    pre.screen {
    border: 1px solid gray;
    padding: 2px;
    background: #FBFFFF;
    font-family: "Courier New", Courier, "Lucida Console", monospace;
    font-size: 95%;
    }

    code.sgmltag-attribute, code.sgmltag-element, code.sgml-emptytag, code.function, 
    code.type, code.exceptionname, code.parameter, code.varname, code.interfacename, 
    code.oointerface, code.classname, code.ooclass, code.methodname, code.coexception,
    code.command, code.option, code.filename, code.literal, code.uri, code.constant,
    code.methodsynopsis, pre.classsynopsis, span.type, span.markup 
    {
    font-family: "Courier New", Courier, "Lucida Console", monospace;
    font-size: 95%;
    }

    code.sgmltag-attvalue, 
    code.filename em.replaceable, 
    code.literal  em.replaceable, 
    code.filename em.replaceable code,
    code.literal  em.replaceable code {
    font-family: "Courier New", Courier, "Lucida Console", monospace;
    font-style: italic;
    }

    em.replaceable {
    font-style: italic;
    }

    code.sgmltag-element:before {
    content:'<';
    }

    code.sgmltag-element:after {
    content:'>';
    } 

    h2 code.sgmltag-element, h3 code.sgmltag-element, h4 code.sgmltag-element {
    font-family: inherit; 
    }

    strong.command, strong.keycap {
    color: #333333;
    }

    strong.userinput {
    font-family: "Courier New", Courier, "Lucida Console", monospace;
    font-size: 90%;
    font-weight: 500;
    background-color: #e0e0e0;
    }

    p.nospaceabove {
    margin-top: -1.0em;
    }

    div#header {
    margin: 0;
    padding-bottom: 0;
    text-align: left;
    font-size : 90%;
    }

    p#readmebanner {
    font-size: 100%;
    font-weight: bold;
    text-align: center;
    color: navy;
    border-bottom: 1px solid #333;
    }

    div.toc dt {
    font-weight: normal;
    line-height: 1em;
    margin-top: 0;
    margin-bottom: 0.35em;
    }

    div.article>div.section, div.preface>div.section {
    padding: 0 10px 0 10px;
    }

    div#footer {
    padding-left: 0;
    border-top: 1px solid #333;
    font-size: 90%;
    margin-top: 18pt;
    }

    div#footer p {
    margin-top: 0;
    }

    </style>
  </head>
  <body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
    <a name="_top"></a>
    <div id="header">
    </div>

    <div id="subPageMasthead">
      <p id="readmebanner">
        StreamBase Documentation
      </p>
    </div>

    <div class="article">
      <div class="titlepage">
        <div>
          <div>
            <h1 class="title">
              <a name="Gather" id="Gather"></a>Gather Operator Sample
            </h1>
          </div>
        </div>
      </div>
      <a class="ix" name="Gather sample"></a><a class="ix" name=
      "Gather operator, using"></a><a class="ix" name="samples, Gather operator"></a>
      <p>
        The <code class="filename">Gather.sbapp</code> sample application has two EventFlows. The
        SimpleGather example uses a Gather operator to generate an alarm (a <code class=
        "literal">true</code> value) for trades of 10,000 shares or more for a stock whose price is
        $200 or greater. The input stream contains the fields <code class="literal">Symbol</code>,
        <code class="literal">Volume</code>, and <code class="literal">Price</code>.
      </p>

      <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
        <h3 class="title">
          Note
        </h3>

        <p>
          This is a very simple example which might be better done using a single Map operator, but
          it is instructive. For an example that truly requires a Gather operator, see the
          Compliance sample application.
        </p>
      </div>

      <p>
        The TimeoutGather example demonstrates the effect of the Optional Timeouts settings. In
        this case, when no input is received for ten seconds, Gather is forced to emit whatever
        tuple values it has accumulated, setting any fields not received to null. The input stream
        has two string fields: Type (which must be enqueued as either <strong class=
        "userinput"><code>Buy</code></strong> or <strong class=
        "userinput"><code>Sell</code></strong>) and Symbol (which can be any string).
      </p>

      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title" style="clear: both">
                <a name="d0e12026" id="d0e12026"></a>Running Gather.sbapp in <span>StreamBase
                Studio</span>
              </h2>
            </div>
          </div>
        </div>

        <p>
          To run the SimpleGather example:
        </p>

        <div class="orderedlist">
          <ol class="orderedlist" type="1" compact>
            <li class="listitem">
              <p>
                In the Package Explorer, double-click to open the <code class=
                "filename">Gather.sbapp</code> application. Make sure the application is the
                currently active tab in the EventFlow Editor.
              </p>
            </li>

            <li class="listitem">
              <p>
                Click the <span class="guilabel">Run</span> button. This opens the SB Test/Debug
                perspective and starts the application.
              </p>
            </li>

            <li class="listitem">
              <p>
                In the Application Output view, select the BigTradeAlarm output stream. No output
                is displayed at this point, but the dequeuer is prepared to receive output. This
                view will eventually show the output of the application.
              </p>
            </li>

            <li class="listitem">
              <p>
                In the Manual Input view, select the TradesIn input stream.
              </p>
            </li>

            <li class="listitem">
              <p>
                Enter <strong class="userinput"><code>intc</code></strong>, <strong class=
                "userinput"><code>10000</code></strong>, and <strong class=
                "userinput"><code>201</code></strong> in the Symbol, Volume, and Price fields,
                respectively
              </p>
            </li>

            <li class="listitem">
              <p>
                Click Send Data, and observe this data appears in the BigTradeAlarm stream:
              </p>

              <pre class="programlisting">
BigTradeAlarm=true
</pre>
            </li>

            <li class="listitem">
              <p>
                Enter <strong class="userinput"><code>intc</code></strong>, <strong class=
                "userinput"><code>10000</code></strong>, and <strong class=
                "userinput"><code>199</code></strong> in the Symbol, Volume, and Price fields,
                respectively
              </p>
            </li>

            <li class="listitem">
              <p>
                Click Send Data, and observe this data appears in the BigTradeAlarm stream:
              </p>

              <pre class="programlisting">
BigTradeAlarm=false
</pre>
            </li>

            <li class="listitem">
              <p>
                Enter <strong class="userinput"><code>intc</code></strong>, <strong class=
                "userinput"><code>1000</code></strong>, and <strong class=
                "userinput"><code>201</code></strong> in the Symbol, Volume, and Price fields,
                respectively
              </p>
            </li>

            <li class="listitem">
              <p>
                Click Send Data, and observe this data appears in the BigTradeAlarm stream:
              </p>

              <pre class="programlisting">
BigTradeAlarm=false
</pre>
            </li>

            <li class="listitem">
              <p>
                Enter <strong class="userinput"><code>intc</code></strong>, <strong class=
                "userinput"><code>1000</code></strong>, and <strong class=
                "userinput"><code>187</code></strong> in the Symbol, Volume, and Price fields,
                respectively
              </p>
            </li>

            <li class="listitem">
              <p>
                Click Send Data, and observe this data appears in the BigTradeAlarm stream:
              </p>

              <pre class="programlisting">
BigTradeAlarm=false
</pre>
            </li>
          </ol>
        </div>

        <p>
          To run the TimeoutGather example:
        </p>

        <div class="orderedlist">
          <ol class="orderedlist" type="1" compact>
            <li class="listitem">
              <p>
                In the Package Explorer, double-click to open the <code class=
                "filename">Gather.sbapp</code> application. Make sure the application is the
                currently active tab in the EventFlow Editor.
              </p>
            </li>

            <li class="listitem">
              <p>
                Click the <span class="guilabel">Run</span> button. This opens the SB Test/Debug
                perspective and starts the application.
              </p>
            </li>

            <li class="listitem">
              <p>
                In the Application Output view, select the Matches output stream. No output is
                displayed at this point, but the dequeuer is prepared to receive output. This view
                will eventually show the output of the application.
              </p>
            </li>

            <li class="listitem">
              <p>
                In the Manual Input view, select the SimpleBuySellMatch input stream.
              </p>
            </li>

            <li class="listitem">
              <p>
                Enter <strong class="userinput"><code>Buy</code></strong> and <strong class=
                "userinput"><code>intc</code></strong> in the Type and Symbol fields, respectively,
                and press <span class="guibutton">Send Data</span>.
              </p>
            </li>

            <li class="listitem">
              <p>
                Quickly change Type from <strong class="userinput"><code>Buy</code></strong> to
                <strong class="userinput"><code>Sell</code></strong> and press <span class=
                "guibutton">Send Data</span> again.
              </p>
            </li>

            <li class="listitem">
              <p>
                Observe this data appear in the Matches stream:
              </p>

              <pre class="programlisting">
MatchedSymbol=intc
</pre>
            </li>

            <li class="listitem">
              <p>
                Now change Type from <strong class="userinput"><code>Sell</code></strong> back to
                <strong class="userinput"><code>Buy</code></strong> again, and press <span class=
                "guibutton">Send Data</span>.
              </p>
            </li>

            <li class="listitem">
              <p>
                Do not send a Sell message. After 10 seconds, observe that the Gather operator
                times out, and writes the following to the Matches output stream:
              </p>

              <pre class="programlisting">
MatchedSymbol=&lt;No Match: intc,null&gt;
</pre>
            </li>
          </ol>
        </div>

        <p>
          When done, press <span class="keycap"><strong>F9</strong></span> or click the
          <span class="guilabel">Stop Running Application</span> button.
        </p>
      </div>

      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title" style="clear: both">
                <a name="d0e12195" id="d0e12195"></a>Running Gather.sbapp in Terminal Windows
              </h2>
            </div>
          </div>
        </div>

        <p>
          This section describes how to run the sample in UNIX terminal windows or Windows command
          prompt windows. On Windows, be sure to use the <span><span>StreamBase</span> Command
          Prompt</span> from the Start menu as described in the <em class="citetitle">Test/Debug
          Guide</em>, not the default command prompt.
        </p>

        <p>
          To run the SimpleGather example:
        </p>

        <div class="orderedlist">
          <ol class="orderedlist" type="1" compact>
            <li class="listitem">
              <p>
                Open three terminal windows on UNIX, or three <span><span>StreamBase</span> Command
                Prompt</span>s on Windows. In each window, navigate to the directory where the
                sample is installed, or to your workspace copy of the sample, as described above.
              </p>
            </li>

            <li class="listitem">
              <p>
                In window 1, type:
              </p>

              <p>
                <strong class="userinput"><code>sbd Gather.sbapp</code></strong>
              </p>

              <p>
                The window shows <code class="literal">notice[StreamBaseServer] listening on port
                10000</code>.
              </p>
            </li>

            <li class="listitem">
              <p>
                In window 2: type:
              </p>

              <p>
                <strong class="userinput"><code>sbc dequeue BigTradeAlarm</code></strong>
              </p>

              <p>
                No output is displayed at this point, but the dequeuer is prepared to receive
                output. This window will eventually show the output of the application.
              </p>
            </li>

            <li class="listitem">
              <p>
                In window 3, type:
              </p>

              <p>
                <strong class="userinput"><code>sbc enqueue TradesIn</code></strong>
              </p>

              <p>
                The <span class="command"><strong>sbc</strong></span> command is now awaiting
                keyboard input. Then type: <strong class="userinput"><code>intc, 10000,
                201</code></strong>
              </p>

              <p>
                Observe this line in the dequeue window: <code class="literal">true</code>
              </p>
            </li>

            <li class="listitem">
              <p>
                Type:
              </p>

              <p>
                <strong class="userinput"><code>intc, 10000, 199.</code></strong>
              </p>

              <p>
                Observe this line in the dequeue window: <code class="literal">false</code>
              </p>
            </li>

            <li class="listitem">
              <p>
                Type:
              </p>

              <p>
                <strong class="userinput"><code>intc, 1000, 201.</code></strong>
              </p>

              <p>
                Observe this line in the dequeue window: <code class="literal">false</code>
              </p>
            </li>

            <li class="listitem">
              <p>
                Type:
              </p>

              <p>
                <strong class="userinput"><code>intc, 1000, 187.</code></strong>
              </p>

              <p>
                Observe this line in the dequeue window: <code class="literal">false</code>
              </p>
            </li>

            <li class="listitem">
              <p>
                In window 3, type: <span class="keycap"><strong>Ctrl</strong></span>+<span class=
                "keycap"><strong>Z</strong></span> (Windows) or <span class=
                "keycap"><strong>Ctrl</strong></span>+<span class=
                "keycap"><strong>D</strong></span> (UNIX) to exit the <span class=
                "command"><strong>sbc</strong></span> session.
              </p>
            </li>

            <li class="listitem">
              <p>
                In window 3, type the following command to terminate the server and dequeuer:
              </p>

              <p>
                <strong class="userinput"><code>sbadmin shutdown</code></strong>
              </p>
            </li>
          </ol>
        </div>

        <p>
          To run the TimeoutGather example:
        </p>

        <div class="orderedlist">
          <ol class="orderedlist" type="1" compact>
            <li class="listitem">
              <p>
                Open three terminal windows on UNIX, or three <span><span>StreamBase</span> Command
                Prompt</span>s on Windows. In each window, navigate to the directory where the
                sample is installed, or to your workspace copy of the sample, as described above.
              </p>
            </li>

            <li class="listitem">
              <p>
                In window 1, type:
              </p>

              <p>
                <strong class="userinput"><code>sbd Gather.sbapp</code></strong>
              </p>

              <p>
                The window shows <code class="literal">notice[StreamBaseServer] listening on port
                10000</code>.
              </p>
            </li>

            <li class="listitem">
              <p>
                In window 2: type:
              </p>

              <p>
                <strong class="userinput"><code>sbc dequeue Matches</code></strong>
              </p>

              <p>
                No output is displayed at this point, but the dequeuer is prepared to receive
                output. This window will eventually show the output of the application.
              </p>
            </li>

            <li class="listitem">
              <p>
                In window 3, type:
              </p>

              <p>
                <strong class="userinput"><code>sbc enqueue SimpleBuySellMatch</code></strong>
              </p>

              <p>
                The <span class="command"><strong>sbc</strong></span> command is now awaiting
                keyboard input. Then type: <strong class="userinput"><code>Buy,
                intc</code></strong>
              </p>
            </li>

            <li class="listitem">
              <p>
                Still in window 3, quickly type:
              </p>

              <p>
                <strong class="userinput"><code>Sell, intc</code></strong>
              </p>

              <p>
                Observe this line in the dequeue window: <code class="literal">intc</code>
              </p>
            </li>

            <li class="listitem">
              <p>
                In window 3, now type:
              </p>

              <p>
                <strong class="userinput"><code>Buy, intc</code></strong>
              </p>

              <p>
                Stop typing now and wait until the dequeue window displays: <code class=
                "literal">&lt;No Match: intc,null&gt;</code>
              </p>

              <p>
                The application's Gather operator reports any unmatched tuples due to its timeout
                setting, which in this example is set to 10 seconds.
              </p>
            </li>

            <li class="listitem">
              <p>
                In window 3, type: <span class="keycap"><strong>Ctrl</strong></span>+<span class=
                "keycap"><strong>Z</strong></span> (Windows) or <span class=
                "keycap"><strong>Ctrl</strong></span>+<span class=
                "keycap"><strong>D</strong></span> (UNIX) to exit the <span class=
                "command"><strong>sbc</strong></span> session.
              </p>
            </li>

            <li class="listitem">
              <p>
                In window 3, type the following command to terminate the server and dequeuer:
              </p>

              <p>
                <strong class="userinput"><code>sbadmin shutdown</code></strong>
              </p>
            </li>
          </ol>
        </div>

        <p>
          <a class="link" href="Gather_README.html" title="Gather Operator Sample">Back to Top
          ^</a>
        </p>
      </div>

      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title" style="clear: both">
                <a name="d0e12401" id="d0e12401"></a>Sample Location
              </h2>
            </div>
          </div>
        </div>

        <p>
          When you load the sample into StreamBase Studio, Studio copies the sample's files to a
          project folder in your Studio workspace directory. Because the Studio workspace location
          is normally part of your home directory, you have full access rights there by default.
        </p>

        <div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">
          <h3 class="title">
            Important
          </h3>

          <p>
            Load this sample in StreamBase Studio, and thereafter use the Studio workspace copy of
            the sample to run and test it, even when running from the command prompt.
          </p>
        </div>

        <p>
          Using the workspace copy of the sample avoids the permission problems that can occur when
          trying to work with the initially installed location of the sample. The default workspace
          location for this sample is:
        </p>

        <pre class="programlisting">
<em class="replaceable"><code>studio-workspace</code></em>/sample_operator
</pre>
        <p>
          See <span>Default Installation Directories in the <em class="citetitle">Installation
          Guide</em></span> for the <span><span>location</span></span> of <em class=
          "replaceable"><code>studio-workspace</code></em> on your system.
        </p>

        <p>
          In the default TIBCO StreamBase installation, this sample's files are initially installed
          in:
        </p>

        <pre class="programlisting">
<em class="replaceable"><code>streambase-install-dir</code></em>/sample/operator
</pre>
        <p>
          See <span>Default Installation Directories in the <em class="citetitle">Installation
          Guide</em></span> for the location of <em class=
          "replaceable"><code>streambase-install-dir</code></em> on your system. This location may
          require administrator privileges for write access, depending on your platform.
        </p>
      </div>
    </div>

    <div id="footer">
      <p>
        Copyright © 2004-2015 TIBCO Software Inc. All rights reserved.
      </p>
    </div>
  </body>
</html>
